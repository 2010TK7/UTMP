jQuery.extend(jQuery.ajax,{_requestCache:{}});jQuery.extend({QP:{config:{domainPrefix:"https://dzqun.gtimg.cn/plaza/scripts/plugin/qgc.qq.com",loginDaId:151,loginJS:"https://dzqun.gtimg.cn/plaza/scripts/plugin/qzfl.login.js",verifyCodeJS:"https://dzqun.gtimg.cn/plaza/scripts/plugin/qzfl.verifycode.js",ptLogoutJS:"https://ui.ptlogin2.qq.com/js/ptloginout.js",storageJS:"https://dzqun.gtimg.cn/plaza/scripts/plugin/qzfl.storage.js",qzfl:"https://qzonestyle.gtimg.cn/ac/qzfl/release/qzfl_for_qzone.js"},loadQZFL:function(callback){if(typeof QZFL==="undefined"){jQuery.getScript(jQuery.QP.config.qzfl,callback)}else{if(typeof callback==="function"){callback()}else{if(callback){eval(callback)}}}},dialogId:1,dialog:[],MSG_TYPE:{INFO:1,RIGHT:4,ERROR:5,LOADING:6},charset:jQuery.browser.mozilla?document.characterSet:document.charset,checkAll:function(d,f,c){var c=c?c:"chkall";var b=0;for(var a=0;a<d.elements.length;a++){var g=d.elements[a];if(g.name&&g.name!==c&&!g.disabled&&(!f||(f&&g.name.match(f)))){g.checked=d.elements[c].checked;if(g.checked){b++}}}return b},reload:function(a,b){a=a||"";b=b||1;re=/^http(s)?:\/\/(.+\.)*?(qq\.com)(\/.*)*/;setTimeout(function(){if(re.test(a)){window.location.href=a}else{window.location.reload()}},b)},errorTips:function(b,c){if(jQuery("#"+c).parent().is("p")){var a='<span class="errorTips">'+b+"</span>"}else{var a='<p class="errorTips">'+b+"</p>"}jQuery("#"+c+" .errorTips").hide();jQuery("#"+c+" .rightTips").hide();jQuery("#"+c).append(a)},rightTips:function(b,c){if(jQuery("#"+c).parent().is("p")){var a='<span class="rightTips">'+b+"</span>"}else{var a='<p class="rightTips">'+b+"</p>"}jQuery("#"+c+" .errorTips").hide();jQuery("#"+c+" .rightTips").hide();jQuery("#"+c).append(a)},clearTips:function(a){jQuery("#"+a+" .errorTips").hide();jQuery("#"+a+" .rightTips").hide()},centerImg:function(g){var c=jQuery(g);var a=c.parents("div").first();var k=a.width();var f=a.height();var h=c.prop("width");var b=c.prop("height");var j=k-h;var d=f-b;c.css({position:"relative",left:parseInt(j/2)+"px",top:parseInt(d/2)+"px"})},strlen:function(a){return(jQuery.browser.msie&&a.indexOf("\n")!==-1)?a.replace(/\r?\n/g,"_").length:a.length},mb_cutstr:function(f,e,b){var a=0;var c="";var b=!b&&b!==""?"...":b;e=e-b.length;for(var d=0;d<f.length;d++){a+=f.charCodeAt(d)<0||f.charCodeAt(d)>255?(jQuery.QP.charset.toLowerCase()==="utf-8"?3:2):1;if(a>e){c+=b;break}c+=f.substr(d,1)}return c},getScrollHeight:function(a){var b=a||document;return Math.max(b.documentElement.scrollHeight,b.body.scrollHeight)},getScrollWidth:function(a){var b=a||document;return Math.max(b.documentElement.scrollWidth,b.body.scrollWidth)},adjustObj:function(b,c){var a=jQuery("#"+c);a.height(jQuery.QP.getScrollHeight());a.width(jQuery.QP.getScrollWidth())},msgbox:function(d,a,b){var c=function(){if(d==null||d&&(d=="none"||d.length===0)){return QZFL.widget.msgbox.hide()}b=b||2000;a=a||jQuery.QP.MSG_TYPE.INFO;return QZFL.widget.msgbox.show(d,a,b)};jQuery.QP.loadQZFL(c)},ajax:function(a,c,b){var e="";c=c||null;b.noShowLoading=b.noShowLoading||false;b.dataType=b.dataType||"json";b.isUpload=b.isUpload||false;b.requestIndex=b.requestIndex||"";b.requestMode=b.requestMode||"block";b.noMsg=b.noMsg||false;a=a.indexOf("?")===-1?a+"?":a+"&";a=a.replace(/\&response_type\=[^\&]+/g,"")+"response_type="+b.dataType;a=a.replace(/\&isAjax\=1/g,"")+"&isAjax=1";var d={url:a,data:c,processData:b.isUpload,contentType:b.isUpload?false:"application/x-www-form-urlencoded",type:c?"POST":"GET",dataType:b.dataType,timeout:b.timeout||30000,jsonp:b.dataType==="jsonp"?"callback":null,jsonpCallback:b.dataType==="jsonp"?b.success:null,beforeSend:function(h,g){if(b.requestIndex){if(b.requestMode=="block"){if(jQuery.ajax._requestCache[b.requestIndex]){return false}}else{if(b.requestMode=="abort"){if(jQuery.ajax._requestCache[b.requestIndex]){jQuery.ajax._requestCache[b.requestIndex].abort()}}}}var f=true;if(typeof b.beforeSend=="function"){f=b.beforeSend(h,g)}if(f){jQuery.ajax._requestCache[b.requestIndex]=h;if(!b.noShowLoading){e=setTimeout(function(){jQuery.QP.showLoading()},1000)}}return f},complete:function(g,f){if(jq.ajax._requestCache[b.requestIndex]){jq.ajax._requestCache[b.requestIndex]=null}if(typeof b.complete=="function"){b.complete(g,f)}},success:function(f,h,g){clearTimeout(e);jQuery.QP.showLoading("none");if(b.dataType!=="jsonp"){if(f!==null){if(typeof b.success=="function"){b.success(f,h,g)}}else{if(!b.noMsg){jQuery.QP.msgbox('抱歉：系统出现错误，请您稍候使用！<span class="hide">errno:2</span>',jQuery.QP.MSG_TYPE.INFO,1500)}if(typeof b.error=="function"){b.error()}}}},error:function(f,h,g){clearTimeout(e);jQuery.QP.showLoading("none");if(f.readyState==0||f.status==0){return false}else{if(h!="abort"&&!b.noMsg){jQuery.QP.msgbox('抱歉：系统出现错误，请您稍候使用！<span class="hide">errno:1 '+h+"</span>",jQuery.QP.MSG_TYPE.INFO,1500)}}if(typeof b.error=="function"){b.error()}}};jQuery.ajax(d);return false},ajaxPost:function(url,postData,showId,callback,ajaxOpts,opts){ajaxOpts=ajaxOpts||{};ajaxOpts.noHideParent||jQuery.QP.hideWindows(showId);var fileId=ajaxOpts.fileId||false;ajaxOpts.success=function(s){if(callback&&typeof callback==="function"){callback(s,opts)}else{if(callback){eval(callback)}}if(!ajaxOpts.noDefCB){jQuery.QP._callback(s,showId,1500,opts)}};jQuery.QP.ajax(url,postData,ajaxOpts)},ajaxGet:function(url,showId,callback,ajaxOpts,opts){jQuery.QP.hideWindows(showId);ajaxOpts=ajaxOpts||{};ajaxOpts.success=function(s){if(callback&&typeof callback=="function"){callback(s,opts)}else{if(callback){eval(callback)}}if(!ajaxOpts.noDefCB){jQuery.QP._callback(s,showId,1500,opts)}};jQuery.QP.ajax(url,"",ajaxOpts)},ajaxForm:function(e,c,b){var f="";c.noMsg=c.noMsg||false;c.noJump=c.noJump||false;var a=c.url||jQuery("#"+e).prop("action");a=a.indexOf("?")===-1?a+"?":a+"&";a=a.replace(/\&response_type\=[^\&]+/g,"")+"response_type=json";a=a.replace(/\&isAjax\=1/g,"")+"&isAjax=1";var d={beforeSubmit:function(k,j,h){if(jQuery.ajax._requestCache[e]==1){return false}if(c.autoLogin){if(!checkLogin()){jQuery.QP.showLoginBox();return false}}var g=true;if(typeof c.beforeSubmit=="function"){g=c.beforeSubmit(k,j,h,c)}if(g){jQuery.ajax._requestCache[e]=1;if(c.isShowLoading){f=setTimeout(function(){jQuery.QP.showLoading()},1000)}}return g},success:function(g,h){jQuery.ajax._requestCache[e]=null;clearTimeout(f);jQuery.QP.showLoading("none");if(g==null){jQuery.QP.msgbox('抱歉：系统出现错误，请您稍候使用！<span class="hide">errno:2</span>',jQuery.QP.MSG_TYPE.INFO,1500)}if(typeof g!=="object"){g=jQuery.parseJSON(g)}if(g.errCode==0){if(c.winId){jQuery.QP.hideWindows(c.winId)}if(!c.noMsg){jQuery.QP.msgbox(g.data,jQuery.QP.MSG_TYPE.RIGHT)}if(typeof c.success=="function"){c.success(g,h,c)}if(!c.noJump&&g.jumpURL){jq.QP.reload(g.jumpURL,2000)}}else{if(g.errCode==30426){jQuery.QP.showLoginBox()}else{if(g.errCode){jQuery.QP.msgbox(g.errMessage,jQuery.QP.MSG_TYPE.ERROR)}else{jQuery.QP.msgbox("系统繁忙，请稍后重试",jQuery.QP.MSG_TYPE.ERROR)}}}},url:a,clearForm:c.clearForm,resetForm:c.resetForm,timeout:c.timeout||10000,dataType:c.dataType||"json",error:function(g,j,h){jQuery.ajax._requestCache[e]=null;clearTimeout(f);jQuery.QP.showLoading("none");jQuery.QP.msgbox('抱歉：系统出现错误，请您稍候使用！<span class="hide">errno:1 '+j+"</span>",jQuery.QP.MSG_TYPE.INFO,1500)}};b=b||false;if(b){jq("#"+e).ajaxSubmit(d)}else{jq("#"+e).ajaxForm(d)}},_callback:function(n,g,k,b){jQuery.QP.hideWindows(g);b=b||{};b.closeIds=b.closeIds||[];b.closeCall=b.closeCall||function(o){};b.callback=b.callback||function(o){};b.wopts=b.wopts||{};var f=parseInt(n.errCode);var c=n.errMessage||"抱歉：系统出现错误，请您稍候使用！";var h=n.data||"";var e=n.jumpURL||false;var j=n.hideHTML||false;var m=n.cover||false;var a=typeof(n.dragAble)!=="undefined"&&n.dragAble!==null?n.dragAble:true;var d=n.btnType||3;if(f===0){if(!j){h&&jQuery.QP.msgbox(h,jQuery.QP.MSG_TYPE.RIGHT,k)}else{jQuery.QP.showWindows(g,"",h,b.closeIds,b.closeCall,b.callback,b.wopts)}}else{if(f){c=c+'<span class="hide">code: '+f+"</span>";jQuery.QP.msgbox(c,jQuery.QP.MSG_TYPE.ERROR,k);if(f===30426){setTimeout(function(){jQuery.QP.showLoginBox()},k)}}else{jQuery.QP.msgbox('抱歉：系统出现错误，请您稍候使用！<span class="hide">errno:3</span>',jQuery.QP.MSG_TYPE.INFO,k)}}if(e==="refresh"){setTimeout(function(){window.location.reload()},k)}else{if(e&&typeof e!=="undefined"){var l=/^http(s)?:\/\/(.+\.)*?(qq\.com)(\/.*)*/;if(l.test(e)){setTimeout(function(){window.location.href=e},k)}}}},showLoading:function(a,b){var a=a||"block",b=b||"请稍候...";jQuery("#ajaxwaitid").html(b);jQuery("#ajaxwaitid")[0].style.display=a;if(a==="block"){jQuery.QP.msgbox(b,jQuery.QP.MSG_TYPE.LOADING,0)}else{jQuery.QP.msgbox(null)}},hideLoading:function(){jQuery("#ajaxwaitid").hide();jQuery.QP.msgbox(null)},saveUserData:function(a,b){var c=function(){var d=function(){try{var f="plaza_"+a;QZFL.Storage.set(f,b)}catch(g){}};if(typeof QZFL.Storage==="undefined"||typeof QZFL.Storage.get==="undefined"){jQuery.getScript(jQuery.QP.config.storageJS,d)}else{d()}};jQuery.QP.loadQZFL(c)},loadUserData:function(a){var b="";var c=function(){var d=function(){try{var f="plaza_"+a;b=QZFL.Storage.get(f)}catch(g){}};if(typeof QZFL.Storage==="undefined"||typeof QZFL.Storage.get==="undefined"){jQuery.getScript(jQuery.QP.config.storageJS,d)}else{d()}};jQuery.QP.loadQZFL(c);return b},stats:function(a){var b=new Image(1,1);b.src="https://"+qgcDomain+"/"+sId+"/stats?type="+a},showLoginBox:function(){var a=function(){if(jQuery.browser.msie&&jQuery.browser.version==6){QZFL.widget.loginBox.show()}else{QZFL.widget.loginBox.show(jQuery.QP.config.loginDaId)}};jQuery.QP.loadQZFL(a)},logoutConfirm:function(){if(!confirm("您确定要退出吗?")){return}var b=function(){jQuery.QP.reload()};var a=["uin","skey","zzpaneluin","zzpanelkey","prvk"];jQuery.each(a,function(c,d){QZFL.cookie.del(d)});var a=["p_uin","p_skey"];jQuery.each(a,function(c,d){QZFL.cookie.del(d,jQuery.QP.config.domainPrefix)});if(jQuery.browser.msie&&jQuery.browser.version==6){b()}else{pt_logout.logout(b)}},openMedia:function(g){var f=g.getAttribute("tid");var c=g.getAttribute("bpic");var d=jQuery("#thumb_zin_"+f);var b=jQuery("#thumb_zout_"+f);var a=jQuery("#thumb_zout_"+f+"_img");a.attr("src",c);b.show();d.hide()},closeMedia:function(d){var c=d.getAttribute("tid");var b=jQuery("#thumb_zout_"+c);var a=jQuery("#thumb_zin_"+c);b.hide();a.show()},showWindows:function(h,f,c,a,d,g,b){h=h||"ajaxWin";g=g||function(){};var e=function(){b=b||{};b.noBorder=b.noBorder===false?false:true;if(!b.noBorder){var k='<div class="box_window">'+c||"</div>"}else{var k='<div class="box_window_noborder">'+c||"</div>"}b.width=b.width||"";b.height=b.height||"";b.showMask=typeof b.showMask==="undefined"?true:b.showMask;b.onLoad=function(n){if(d){jQuery(".close").bind("click",d)}a=a||[];jQuery.each(a,function(o,p){jQuery("#"+p).bind("click",function(){j.unload()})});jQuery(".close").bind("click",function(){j.unload()});var m=jQuery("#"+n.contentId+" div :first").height(),l=jQuery("#"+n.contentId+" div :first").width();n.setSize(l,m);g(n)};var j=QZFL.dialog.create(f,k,b);jQuery.QP.dialog.push(h);jQuery.QP.dialog[h]=j};jQuery.QP.loadQZFL(e)},hideWindows:function(b){b=b||"ajaxWin";if(typeof jQuery.QP.dialog[b]=="object"){var a=jQuery.inArray(b,jQuery.QP.dialog);if(a>-1){jQuery.QP.dialog[a]="";jQuery.QP.dialog[b].unload();jQuery.QP.dialog[b]=null}}},loadJS:function(a,f,d,c){c=c||false;f=f||function(){};var e=function(){if(typeof f=="function"){f()}};var b=function(){var h=document.getElementsByTagName("head")[0],g=document.createElement("script");g.setAttribute("type","text/javascript");g.setAttribute("charset","utf-8");g.setAttribute("src",a+"?"+Math.random());g.onload=g.onreadystatechange=function(){if(g.onreadystatechange&&g.readystate&&(g.readystate!=="complete"||g.readystate!=="loaded")){return false}e()};h.appendChild(g)};if(typeof d!=="undefined"&&c==false){e()}else{b()}return true},preventScroll:function(b){var a=document.getElementById(b);if(navigator.userAgent.indexOf("Firefox")>0){a.addEventListener("DOMMouseScroll",function(c){a.scrollTop+=c.detail>0?60:-60;c.preventDefault()},false)}else{a.onmousewheel=function(c){c=c||window.event;a.scrollTop+=c.wheelDelta>0?-60:60;return false}}return true},showDialog:function(b){b.ok=b.ok||null;b.cancle=b.cancle||null;b.okValue=b.okValue||"确认";b.cancleValue=b.cancleValue||"取消";b.contont=b.contont||"是否确认?";var d="",c="";if(typeof b.ok=="function"){d='<input type="button" value="'+b.okValue+'" class="buttongreen" id="dialogOK">'}if(typeof b.cancle=="function"){c='<input type="button" value="'+b.cancleValue+'" class="buttongrey close" id="dialogCancle">'}var a='<div class="w_box box_grey"><div class="w_bm_h cl clearfix"><h2><a title="关闭" id="dialogClose" class="right close">关闭</a></h2></div>'+b.contont+d+c+"</div>";jQuery.QP.showWindows("dialog","",a,null,null,function(){jQuery("#dialogOK").bind("click",function(){if(typeof b.ok=="function"){if(b.ok()){jQuery.QP.hideWindows("dialog")}}else{jQuery.QP.hideWindows("dialog")}});jQuery("#dialogCancle").bind("click",function(){if(typeof b.cancle=="function"){if(b.cancle()){jQuery.QP.hideWindows("dialog")}}else{jQuery.QP.hideWindows("dialog")}})})},isObjectEmpty:function(a){for(i in a){return false}return true}}});jQuery.fn.extend({QP:{centerImg:function(){var b=jQuery(this);var h=b.parents("div").first();var a=h.width();var d=h.height();var e=b.prop("width");var g=b.prop("height");var c=a-e;var f=d-g;b.css({position:"relative",left:parseInt(c/2)+"px",top:parseInt(f/2)+"px"})}}});